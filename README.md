# golangci-lint-check-exit

Check the exit of golangci-lint cli with severity configuration

## Background

[golangci-lint](https://github.com/golangci/golangci-lint) is a great tool for standardising
the codebases where many developers contribute.

One issue is that, some linters should be considered "warning" or "info" level.
That is the linting process should not fail, and thus return an error code, if only
issues that are not of an "error" level are discovered. That is, the return value
of running `golangci-lint ./...` should be `0`.

## How to use

For simplicity in managing environments, this check repo makes use of the [docker containers](https://hub.docker.com/r/golangci/golangci-lint)
for running the cli.

We have two directories that we check. One has a [todo with correct](./withtodo)
spelling:

```go
// TODO: we need to do a thing.
```

While the other one has a [todo with incorrect](./withtoddo) spelling:

```go
// TODDO: we need to do a thing.
```

Out configuration is only for `dupl` and `godox`, both set via the severity block
to `info`.

### Output

Last attempt to use [`run.sh`](./run.sh) with `v1.40.0` yeilded the following:

```console
$ ./run.sh
level=info msg="[config_reader] Config search paths: [./ /app/withtodo /app / /root]"
level=info msg="[config_reader] Used config file .golangci.yml"
level=info msg="[lintersdb] Active 2 linters: [dupl godox]"
level=info msg="[loader] Go packages loading at mode 575 (name|types_sizes|deps|exports_file|imports|compiled_files|files) took 166.412777ms"
level=info msg="[runner/filename_unadjuster] Pre-built 0 adjustments in 1.436862ms"
level=info msg="[linters context/goanalysis] analyzers took 1.960856ms with top 10 stages: dupl: 1.923821ms, godox: 37.035µs"
level=info msg="[runner] Processors filtering stat (out/in): sort_results: 1/1, filename_unadjuster: 1/1, path_prettifier: 1/1, exclude-rules: 1/1, max_per_file_from_linter: 1/1, skip_files: 1/1, exclude: 1/1, nolint: 1/1, diff: 1/1, path_prefixer: 1/1, cgo: 1/1, uniq_by_line: 1/1, max_from_linter: 1/1, path_shortener: 1/1, source_code: 1/1, severity-rules: 1/1, skip_dirs: 1/1, autogenerated_exclude: 1/1, identifier_marker: 1/1, max_same_issues: 1/1"
level=info msg="[runner] processing took 3.526152ms with stages: autogenerated_exclude: 1.276778ms, source_code: 1.066801ms, nolint: 958.703µs, identifier_marker: 91.857µs, exclude-rules: 79.873µs, path_prettifier: 17.913µs, skip_dirs: 7.756µs, exclude: 6.04µs, uniq_by_line: 5.3µs, path_shortener: 3.827µs, max_same_issues: 3.523µs, max_from_linter: 1.326µs, severity-rules: 1.281µs, cgo: 1.256µs, max_per_file_from_linter: 1.107µs, filename_unadjuster: 921ns, sort_results: 714ns, diff: 648ns, skip_files: 413ns, path_prefixer: 115ns"
level=info msg="[runner] linters took 45.285322ms with stages: goanalysis_metalinter: 41.525807ms"
level=info msg="File cache stats: 1 entries of total size 137B"
withtodo/main.go:5: withtodo/main.go:5: Line contains TODO/BUG/FIXME: "TODO: we need to do a thing." (godox)
// TODO: we need to do a thing.
level=info msg="Memory: 4 samples, avg is 71.2MB, max is 71.3MB"
level=info msg="Execution took 224.640225ms"
Checking error output with 'TODO':
output error = '1'
level=info msg="[config_reader] Config search paths: [./ /app/withtoddo /app / /root]"
level=info msg="[config_reader] Used config file .golangci.yml"
level=info msg="[lintersdb] Active 2 linters: [dupl godox]"
level=info msg="[loader] Go packages loading at mode 575 (types_sizes|compiled_files|exports_file|files|name|deps|imports) took 168.625251ms"
level=info msg="[runner/filename_unadjuster] Pre-built 0 adjustments in 1.751494ms"
level=info msg="[linters context/goanalysis] analyzers took 1.650022ms with top 10 stages: dupl: 1.579143ms, godox: 70.879µs"
level=info msg="[runner] processing took 4.17µs with stages: skip_dirs: 789ns, max_same_issues: 710ns, nolint: 521ns, autogenerated_exclude: 361ns, max_from_linter: 237ns, cgo: 177ns, uniq_by_line: 159ns, diff: 156ns, filename_unadjuster: 154ns, identifier_marker: 152ns, skip_files: 150ns, path_prettifier: 143ns, path_shortener: 72ns, source_code: 64ns, sort_results: 62ns, exclude-rules: 59ns, max_per_file_from_linter: 52ns, exclude: 52ns, severity-rules: 51ns, path_prefixer: 49ns"
level=info msg="[runner] linters took 36.705631ms with stages: goanalysis_metalinter: 36.655304ms"
level=info msg="File cache stats: 0 entries of total size 0B"
level=info msg="Memory: 4 samples, avg is 71.2MB, max is 71.3MB"
level=info msg="Execution took 224.3223ms"
Checking error output with 'TODDO':
output passed with '0'
```
